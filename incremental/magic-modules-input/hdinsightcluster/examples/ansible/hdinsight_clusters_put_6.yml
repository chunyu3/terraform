--- !ruby/object:Provider::Ansible::Example
task: !ruby/object:Provider::Ansible::Task
  name: azure_rm_hdinsightcluster
  description: Create Kafka cluster with Kafka Rest Proxy
  code:
    resource_group: myResourceGroup
    cluster_name: myCluster
    cluster_version: '4.0'
    os_type: Linux
    tier: Standard
    cluster_definition:
      kind: kafka
      component_version:
        Kafka: '2.1'
      configurations:
        gateway:
          restAuthCredential.isEnabled: true
          restAuthCredential.username: admin
          restAuthCredential.password: '**********'
    kafka_rest_properties:
      client_group_info:
        group_name: Kafka security group name
        group_id: 00000000-0000-0000-0000-111111111111
    compute_profile:
      roles:
        - name: headnode
          target_instance_count: '2'
          hardware_profile:
            vm_size: Large
          os_profile:
            linux_operating_system_profile:
              username: sshuser
              password: '**********'
        - name: workernode
          target_instance_count: '3'
          hardware_profile:
            vm_size: Large
          os_profile:
            linux_operating_system_profile:
              username: sshuser
              password: '**********'
          data_disks_groups:
            - disks_per_node: '8'
        - name: zookeepernode
          target_instance_count: '3'
          hardware_profile:
            vm_size: Small
          os_profile:
            linux_operating_system_profile:
              username: sshuser
              password: '**********'
        - name: kafkamanagementnode
          target_instance_count: '2'
          hardware_profile:
            vm_size: Standard_D4_v2
          os_profile:
            linux_operating_system_profile:
              username: kafkauser
              password: '**********'
    storage_profile:
      storageaccounts:
        - name: mystorage.blob.core.windows.net
          is_default: true
          container: containername
          key: storagekey
  